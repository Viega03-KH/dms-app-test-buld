import{k as V,Q as K,D as T,L as Q,a as p,o as c,b as s,f as l,v as j,c as w,n as I,E as z,q as D,g as o,J as F,K as $,O,y as J,x as R,d as _,l as B,h as v,R as k,j as P,A as X,t as W,U as G,S as E,s as Z}from"./index-NpEBLJbS.js";import{_ as b,a as q,S as H}from"./UFileCard-BCLyN-Mq.js";import{u as Y,_ as ee}from"./CreateDockForm-BN0tsxby.js";import{X as te}from"./useFormValidate-DJC7jpxC.js";import{C as se}from"./cloud-upload-D27boa5c.js";import{_ as ae}from"./TaskForm-DciPD8jY.js";import{_ as le}from"./UPagination-BF3pV6WL.js";import{P as oe}from"./plus-Fv9FE-lP.js";import{S as ne}from"./square-pen-B9o_X7_l.js";import{T as ie}from"./trash-2-WhNS214r.js";import"./OrganizationForm-Dak-jTdk.js";import"./doctypeStore-CbbgFMiN.js";import"./deliveryStore-BINj1pQ9.js";import"./jurnalStore--BpMQzVp.js";import"./taskStore-Cyz-P3fR.js";import"./usersStore-C98-mjs6.js";import"./subjectStore-YrW79kyc.js";import"./chevron-left-RJlNLR7z.js";import"./chevron-right-6akXjBU1.js";/**
 * @license lucide-vue-next v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L=V("combine",[["path",{d:"M10 18H5a3 3 0 0 1-3-3v-1",key:"ru65g8"}],["path",{d:"M14 2a2 2 0 0 1 2 2v4a2 2 0 0 1-2 2",key:"e30een"}],["path",{d:"M20 2a2 2 0 0 1 2 2v4a2 2 0 0 1-2 2",key:"2ahx8o"}],["path",{d:"m7 21 3-3-3-3",key:"127cv2"}],["rect",{x:"14",y:"14",width:"8",height:"8",rx:"2",key:"1b0bso"}],["rect",{x:"2",y:"2",width:"8",height:"8",rx:"2",key:"1x09vl"}]]);/**
 * @license lucide-vue-next v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U=V("file-input",[["path",{d:"M4 22h14a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v4",key:"1pf5j1"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M2 15h10",key:"jfw4w8"}],["path",{d:"m9 18 3-3-3-3",key:"112psh"}]]);/**
 * @license lucide-vue-next v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const re=V("notepad-text-dashed",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v2",key:"j91f56"}],["path",{d:"M20 12v2",key:"w8o0tu"}],["path",{d:"M20 18v2a2 2 0 0 1-2 2h-1",key:"1c9ggx"}],["path",{d:"M13 22h-2",key:"191ugt"}],["path",{d:"M7 22H6a2 2 0 0 1-2-2v-2",key:"1rt9px"}],["path",{d:"M4 14v-2",key:"1v0sqh"}],["path",{d:"M4 8V6a2 2 0 0 1 2-2h2",key:"1mwabg"}],["path",{d:"M8 10h6",key:"3oa6kw"}],["path",{d:"M8 14h8",key:"1fgep2"}],["path",{d:"M8 18h5",key:"17enja"}]]),de={class:"flex flex-row"},ce={class:"flex-1 min-w-0"},ue={class:"flex items-center justify-between"},me={class:"flex flex-col py-2"},pe={class:"flex items-center justify-between"},fe={class:"flex-1 min-w-0 py-1 text-sm font-medium text-[#697696] line-clamp-2"},he="task card-dark border-b px-3 py-4 cursor-pointer hover:bg-[#4076FF0D]",ve={__name:"DockListItem",props:{dock:{type:Object,required:!0},active:{type:Boolean,default:!1}},setup(a){const e=K(),n=(y,i)=>{e.open(y,{x:i.clientX+10,y:i.clientY+10})},f=a,x=T(()=>Q(f.dock.doc_date).format("DD MMMM YYYY")),u={attached:{name:"Asosiy file mavjud",icon:L,color:"text-green-500"},draft:{name:"File mavjud emas.",icon:re,color:"text-yellow-500"}},h=T(()=>u[f.dock.status]||{name:"Noma'lum",icon:L,color:"text-gray-500"});return(y,i)=>(c(),p("div",{onClick:i[6]||(i[6]=m=>y.$emit("select",a.dock)),class:I([he,a.active?"bg-[#4076FF0D]":""])},[s("div",de,[s("div",ce,[s("div",ue,[s("h4",{onMouseenter:i[0]||(i[0]=m=>n("Kiruvchi raqam",m)),onMouseleave:i[1]||(i[1]=m=>l(e).close()),class:"text-sm font-extrabold text-black"},j(a.dock.in_number),33),s("h4",{onMouseenter:i[2]||(i[2]=m=>n("Ro`yxarga olingan sana",m)),onMouseleave:i[3]||(i[3]=m=>l(e).close()),class:"text-sm font-medium text-[#697696]"},j(x.value),33)]),s("div",me,[s("div",pe,[i[7]||(i[7]=s("span",{class:"flex-1 min-w-0 truncate text-sm font-bold text-black"}," Kiruvchi hujjat ",-1)),(c(),w(z(h.value.icon),{class:I(["w-5 h-5",h.value.color]),onMouseenter:i[4]||(i[4]=m=>n(h.value.name,m)),onMouseleave:i[5]||(i[5]=m=>l(e).close())},null,40,["class"]))]),s("span",fe,j(a.dock.summary),1)])])])],2))}},ke={key:0},ye={class:"grid grid-cols-1 md:grid-cols-2 gap-4 pb-4"},xe={key:0},ge={class:"grid grid-cols-2 gap-2"},be={__name:"DockShowItem",props:{dockfile:{type:Object,default:null}},setup(a){return(e,n)=>a.dockfile?(c(),p("div",ke,[s("div",ye,[o(b,{label:"Kelib tushgan raqam",value:a.dockfile.in_number},null,8,["value"]),o(b,{label:"Chiqish raqami",value:a.dockfile.out_number},null,8,["value"]),o(b,{label:"Hujjat nomi",value:a.dockfile.title,class:"md:col-span-2"},null,8,["value"]),o(b,{label:"Qisqa mazmun",value:a.dockfile.summary,class:"md:col-span-2"},null,8,["value"]),o(b,{label:"Tashkilot",value:a.dockfile.sender?.name},null,8,["value"]),o(b,{label:"Hujjat turi",value:a.dockfile.document_type?.name},null,8,["value"]),o(b,{label:"Yetkazib berish usuli",value:a.dockfile.delivery_type?.name},null,8,["value"]),o(b,{label:"Jurnal",value:a.dockfile.journal.name},null,8,["value"])]),a.dockfile.attachments?.length?(c(),p("div",xe,[n[0]||(n[0]=s("h3",{class:"font-semibold mb-2"},"Fayllar:",-1)),s("div",ge,[(c(!0),p(F,null,$(a.dockfile.attachments,f=>(c(),w(q,{key:f.id,file:f},null,8,["file"]))),128))])])):D("",!0)])):D("",!0)}},we=async({documentId:a,files:e})=>{if(!a)throw new Error("documentId is required");const n=new FormData;(Array.isArray(e)?e:[e]).forEach(u=>n.append("files",u)),n.append("document_id",a);const{data:x}=await O.post("/attachments/",n);return x},De=a=>O.delete(`/attachments/${a}/`),_e=J("attachment",{state:()=>({attachments:[],loading:!1}),actions:{async uploadFiles(a,e){if(!(!a||!e)){this.loading=!0;try{const n=await we({documentId:a,files:e});return Array.isArray(n)&&n.length>0&&this.attachments.push(...n),n}catch(n){throw console.error("Attachment upload failed in store:",n),n}finally{this.loading=!1}}},async deleteAttachment(a){if(a){this.loading=!0;try{await De(a),this.attachments=this.attachments.filter(e=>e.id!==a)}catch(e){throw console.error("Attachment delete failed in store:",e),e}finally{this.loading=!1}}},setAttachments(a){Array.isArray(a)&&(this.attachments=a)}}}),je={class:"w-[40vw] md:w-[40vw] 2xl:w-[40vw] h-auto flex flex-col"},Fe={class:"flex justify-between modal-border items-center p-[14px] border-b"},$e={class:"p-6 w-full h-full pb-10 overflow-y-scroll space-y-6"},Me={class:"flex flex-col gap-2"},Ce={key:0,class:"text-red-500 text-sm"},Ae={key:1,class:"space-y-2 mt-2"},Se={key:2,class:"space-y-2 mt-2"},qe={class:"flex justify-end gap-3 p-4 border-t modal-border"},N={__name:"CreateFileForm",props:{fileID:{type:Number,required:!1},file:{type:Object,required:!1}},setup(a){const e=a,n=R(),f=_e(),x=Y(),u=_([]),h=_([]),y=_(!1),i=_({});B(()=>{e.file?.attachments?.length&&(h.value=[...e.file.attachments],f.setAttachments([...e.file.attachments]))});function m(){u.value=[],n.close()}function M(t){u.value.splice(t,1)}function C(t){f.deleteAttachment(t),h.value=h.value.filter(r=>r.id!==t)}function A(t){const r=Array.from(t.target.files);if(!r.length)return;const d=r.map(S=>Object.assign(S,{isLocal:!0}));u.value.push(...d),t.target.value=""}async function g(){if(!u.value.length&&!h.value.length){i.value.files="Iltimos, fayl tanlang";return}i.value.files=null,y.value=!0;try{if(u.value.length){const t=e.fileID||e.file?.id;if(!t)throw new Error("Document ID mavjud emas");await f.uploadFiles(t,u.value),x.fetchAll(),u.value=[]}(e.fileID||e.file?.id)&&x.fetchAll(),n.close()}catch(t){console.error("Fayl upload xatosi:",t)}finally{y.value=!1}}return(t,r)=>(c(),p("div",je,[s("div",Fe,[r[3]||(r[3]=s("p",{class:"text-black text-md font-bold uppercase"},"Fayl qo'shish",-1)),o(k,{customClass:"bg-[#475467] rounded-full p-1",onClick:m},{default:v(()=>[o(l(te),{"stroke-width":"3",class:"w-3 h-3 text-white"})]),_:1})]),s("div",$e,[s("div",Me,[s("div",{class:"flex flex-col border border-[#EAECF0] shadow-sm rounded-[12px] items-center text-center justify-center p-6 cursor-pointer hover:border-blue-400 transition-colors",onDrop:r[0]||(r[0]=(...d)=>t.onDrop&&t.onDrop(...d)),onDragover:r[1]||(r[1]=(...d)=>t.onDragOver&&t.onDragOver(...d)),onClick:r[2]||(r[2]=d=>t.$refs.fileInput.click())},[o(l(se),{"stroke-width":"1",class:"w-10 h-10 text-gray-400"}),r[4]||(r[4]=s("p",{class:"text-gray-500 py-2"},"Fayllarni bu yerga torting yoki tanlang",-1)),s("input",{ref:"fileInput",type:"file",class:"hidden",multiple:!0,accept:".pdf,.docx,.jpg,.png",onChange:A},null,544)],32),i.value.files?(c(),p("p",Ce,j(i.value.files),1)):D("",!0),u.value.length?(c(),p("div",Ae,[(c(!0),p(F,null,$(u.value,(d,S)=>(c(),w(q,{key:d.name,file:d,"show-delete":!0,onRemove:()=>M(S)},null,8,["file","onRemove"]))),128))])):D("",!0),h.value.length?(c(),p("div",Se,[(c(!0),p(F,null,$(h.value,d=>(c(),w(q,{key:d.id,file:d,"show-delete":!0,onRemove:()=>C(d.id)},null,8,["file","onRemove"]))),128))])):D("",!0)])]),s("div",qe,[o(k,{variant:"ghost",onClick:m},{default:v(()=>[...r[5]||(r[5]=[P("Bekor qilish",-1)])]),_:1}),o(k,{variant:"primary",onClick:g,loading:y.value},{default:v(()=>[...r[6]||(r[6]=[P(" Saqlash va yuborish ",-1)])]),_:1},8,["loading"])])]))}},Ve={class:"mx-auto"},Te={class:"grid grid-cols-1 lg:grid-cols-12"},Ie={class:"col-span-12 md:col-span-5 2xl:col-span-3"},Pe={class:"card-dark border-b-2 border-x shadow-sm"},Ee={class:"flex px-1 py-3 items-center border-b card-border justify-between"},He={class:"flex items-center"},Le={class:"flex gap-1"},Ue={class:"h-[calc(100vh-8rem)] overflow-y-auto"},Ne={class:"col-span-12 md:col-span-7 2xl:col-span-9 space-y-2 px-3 h-[calc(100vh-4rem)] overflow-y-auto"},Oe={class:"card-dark rounded-b border-b border-x"},Re={key:0},Be={class:"flex px-1 py-2 items-center border-b card-border justify-between"},Ye={class:"flex items-center gap-2"},Ke={class:"flex justify-end p-4 bg-[#F4F6FC]"},Qe={key:1,class:"flex flex-col"},ze={class:"grid grid-cols-3 p-6 gap-4"},Je={class:"flex bg-[#F4F6FC] items-center gap-4 justify-end p-6"},ht={__name:"TransmittedViews",setup(a){const e=Y(),n=R(),f=[{label:"Qoralama hujjatlar",name:"draft"},{label:"Ro`yxatga olingan hujjatlar",name:"attached"}],x=g=>e.fetchAll(g),u=g=>{e.selectedDock=g},h=()=>{e.selectedDock=null},y=()=>e.fetchAll(1),i=()=>{e.status="",e.in_number="",e.out_number="",e.fetchAll(1)},m=()=>{e.selectedDock&&n.open(ae,{id:e.selectedDock.id})},M=()=>{e.selectedDock&&n.open(ee,{selectedFile:e.selectedDock})},C=()=>{e.selectedDock&&n.open(N,{fileID:e.selectedDock.id})},A=()=>{e.selectedDock&&n.open(N,{file:e.selectedDock})};return X(()=>e.docks,g=>{if(e.selectedDock){const t=g.find(r=>r.id===e.selectedDock.id);t?e.selectedDock=t:e.selectedDock=null}},{deep:!0}),B(()=>{e.fetchAll(1)}),(g,t)=>{const r=Z("wave");return c(),p("div",Ve,[s("div",Te,[s("div",Ie,[s("div",Pe,[s("div",Ee,[s("div",He,[W((c(),w(k,{onClick:h,variant:"hover"},{default:v(()=>[o(l(H),{"stroke-width":"2",class:"w-6 h-6"})]),_:1})),[[r]]),t[3]||(t[3]=s("h2",{class:"text-[14px] p-2 font-bold uppercase text-[#282F3D]"},"Hujjatlar",-1))]),s("div",Le,[o(le,{currentPage:l(e).pagination.currentPage,previous:l(e).pagination.previous,next:l(e).pagination.next,lastPage:Math.ceil(l(e).pagination.count/10),total:l(e).pagination.count,loading:l(e).loading,onChange:x},null,8,["currentPage","previous","next","lastPage","total","loading"])])]),s("div",Ue,[(c(!0),p(F,null,$(l(e).docks,d=>(c(),w(ve,{key:d.id,dock:d,active:l(e).selectedDock?.id===d.id,onSelect:u},null,8,["dock","active"]))),128)),t[4]||(t[4]=s("div",{class:"h-24 w-full"},null,-1))])])]),s("div",Ne,[s("div",Oe,[l(e).selectedDock?(c(),p("div",Re,[s("div",Be,[t[7]||(t[7]=s("h2",{class:"text-[14px] p-2 font-bold uppercase text-[#282F3D]"},"Kiruvchi hujjat",-1)),s("div",Ye,[o(k,{onClick:m,variant:"primary"},{default:v(()=>[o(l(oe),{"stroke-width":"3",class:"text-white"}),t[5]||(t[5]=s("span",{class:"px-1"},"Topshiriq yaratish",-1))]),_:1}),o(k,{onClick:M,variant:"primary"},{default:v(()=>[o(l(ne),{"stroke-width":"3",class:"text-white w-6 h-4"}),t[6]||(t[6]=s("span",{class:"px-1"},"Tahrirlash",-1))]),_:1})])]),o(be,{dockfile:l(e).selectedDock,class:"p-6"},null,8,["dockfile"]),s("div",Ke,[l(e).selectedDock?.attachments?.length?(c(),w(k,{key:0,onClick:A,variant:"primary"},{default:v(()=>[o(l(U),{"stroke-width":"2",class:"text-white"}),t[8]||(t[8]=s("span",{class:"px-1"},"File va ilovani yangilash",-1))]),_:1})):(c(),w(k,{key:1,onClick:C,variant:"primary"},{default:v(()=>[o(l(U),{"stroke-width":"2",class:"text-white"}),t[9]||(t[9]=s("span",{class:"px-1"},"File va ilova qo'shish",-1))]),_:1}))])])):(c(),p("div",Qe,[s("div",null,[t[10]||(t[10]=s("div",{class:"flex p-3 items-center card-border border-b justify-between"},[s("h2",{class:"text-[14px] py-2 font-bold uppercase text-[#282F3D]"},"Qidirish")],-1)),s("div",ze,[o(G,{modelValue:l(e).status,"onUpdate:modelValue":t[0]||(t[0]=d=>l(e).status=d),options:f,"option-label":"label","option-value":"name",placeholder:"Hujjat holati"},null,8,["modelValue"]),o(E,{modelValue:l(e).in_number,"onUpdate:modelValue":t[1]||(t[1]=d=>l(e).in_number=d),placeholder:"Hujjat raqami"},null,8,["modelValue"]),o(E,{modelValue:l(e).out_number,"onUpdate:modelValue":t[2]||(t[2]=d=>l(e).out_number=d),placeholder:"Chiqish raqami"},null,8,["modelValue"])])]),s("div",Je,[o(k,{class:"flex items-center",onClick:i},{default:v(()=>[o(l(ie),{"stroke-width":"2.5",class:"w-5 h-5"}),t[11]||(t[11]=s("span",{class:"px-2"},"Tozalash",-1))]),_:1}),o(k,{variant:"primary",class:"flex items-center",onClick:y},{default:v(()=>[o(l(H),{"stroke-width":"2.5",class:"w-5 h-5"}),t[12]||(t[12]=s("span",{class:"px-2"},"Qidirish",-1))]),_:1})])]))])])])])}}};export{ht as default};
