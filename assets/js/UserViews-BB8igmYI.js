import{u as e}from"./usersStore-fKCvmNci.js";import{u as a,b as l,f as s}from"./index-Bbk9u_eB.js";import{B as r}from"./BaseCrudTable-DuefH3Qn.js";import{_ as i}from"./UPagination-BTpY5yYN.js";import{X as t,S as o,z as n,y as d}from"./ui-vendor-Dpi5LIj3.js";import{B as u,c as m,o as c,e as p,b as h,w as f,u as g,O as b,k as v,z as y,t as x,x as _,j as w,F as k,r as U,a as V,p as j}from"./vue-vendor-D8IdSx1h.js";import{u as F}from"./useFormValidate-WCLlqkIO.js";import{u as q}from"./departmentStore-COiQGNNG.js";import{u as C}from"./user-BRUuMk4P.js";import{_ as I}from"./BaseTableHeader-tCkohxt0.js";import"./utils-DZp7J2GC.js";/* empty css                                                                      */const z={class:"max-w-xl max-h-xl"},B={class:"flex justify-between modal-border items-center p-[14px] border-b"},P={class:"justify-end border-t modal-card flex gap-2 p-4"},S={__name:"UserDelete",props:{userId:{type:Number,required:!0}},setup(s){const r=s,i=e(),o=a(),n=l(),d=async()=>{try{await i.removeUser(r.userId),o.show("Foydalanuvchi muvaffaqiyatli o‘chirildi!","success"),n.close()}catch(e){o.show("Xatolik yuz berdi!","error")}};return(e,a)=>{const l=u("UButton");return c(),m("div",z,[p("div",B,[a[2]||(a[2]=p("p",{class:"text-gray-600 text-lg font-semibold"},"Foydalanuvchini o‘chirish",-1)),h(l,{customClass:"bg-gray-300 rounded-full p-1",onClick:a[0]||(a[0]=e=>g(n).close())},{default:f(()=>[h(g(t),{"stroke-width":"3",class:"w-4 h-4 text-white"})]),_:1})]),a[5]||(a[5]=p("div",{class:"p-4 text-center space-y-4"},[p("p",{class:"text-base text-dark"},"Siz rostdan ham bu foydalanuvchi ma'lumotlarini o‘chirmoqchimisiz?")],-1)),p("div",P,[h(l,{variant:"ghost",onClick:a[1]||(a[1]=e=>g(n).close()),disabled:g(i).loading},{default:f(()=>[...a[3]||(a[3]=[b("Bekor qilish",-1)])]),_:1},8,["disabled"]),h(l,{variant:"danger",onClick:d,loading:g(i).loading},{default:f(()=>[...a[4]||(a[4]=[b("O‘chirish",-1)])]),_:1},8,["loading"])])])}}},Y={class:"flex flex-col max-w-2xl"},O={class:"flex justify-between modal-border items-center p-[14px] border-b"},T={class:"text-gray-600 text-sm font-bold uppercase"},L={class:"flex flex-wrap -mx-2 p-4"},M={class:"w-full px-2 py-2 xl:w-1/2"},E={class:"w-full px-2 py-2 xl:w-1/2"},A={class:"w-full px-2 py-2 xl:w-1/2"},D={class:"w-full px-2 py-2 xl:w-1/2"},N={class:"w-full px-2 py-2 xl:w-1/2"},Q={class:"w-full px-2 py-2 xl:w-1/2"},H={class:"w-full px-2 py-2 xl:w-1/2"},R={class:"w-full px-2 py-2 xl:w-1/2"},X={class:"justify-end border-t modal-card modal-border flex items-center p-4 gap-2"},G={__name:"UserForm",props:{userId:{type:Number,default:null}},setup(s){const r=s,i=e(),o=q();a();const n=l(),d=v(()=>!!r.userId),w={username:{required:!0,message:"Ism majburiy"},email:{required:!0,message:"Email majburiy"},last_name:{required:!0,message:"Familiya majburiy"},first_name:{required:!0,message:"Sharif majburiy"},father_name:{required:!0,message:"Otasining ismi majburiy"},position:{required:!0,message:"Lavozim majburiy"},department_id:{required:!0,message:"Bo‘lim majburiy"},password:{required:!r.userId,message:"Parol majburiy"}},{form:k,errors:U,validate:V,resetForm:j}=F({id:"",username:"",email:"",last_name:"",first_name:"",father_name:"",position:"",department_id:"",password:""},w);y(async()=>{const e=[];if(o.departments.length||e.push(o.fetchAll()),r.userId&&e.push(i.fetchUser(r.userId)),await Promise.all(e),r.userId&&i.selectedUser){const e=i.selectedUser;k.username=e.username,k.last_name=e.last_name,k.first_name=e.first_name,k.father_name=e.father_name,k.position=e.position,k.email=e.email,k.department_id=e.department?.id}});const C=()=>{j(),n.close()},I=async()=>{if(!V()||i.loading)return;let e;try{const a={...k};d.value||delete a.id,a.password||delete a.password,e=d.value?await i.editUser(r.userId,a):await i.addUser(a),e.success&&C()}catch(a){return}};return(e,a)=>{const l=u("UButton"),s=u("UInput"),r=u("USelect");return c(),m("div",Y,[p("div",O,[p("p",T,x(d.value?"Foydalanuvchini tahrirlash":"Foydalanuvchi qo‘shish"),1),h(l,{customClass:"bg-gray-300 rounded-full p-1",onClick:C},{default:f(()=>[h(g(t),{"stroke-width":"3",class:"w-4 h-4 text-white"})]),_:1})]),p("form",{onSubmit:_(I,["prevent"]),class:"space-y-6"},[p("div",L,[p("div",M,[h(s,{modelValue:g(k).username,"onUpdate:modelValue":a[0]||(a[0]=e=>g(k).username=e),label:"Foydalanuvchi nomi",placeholder:"Foydalanuvchi nomini kiriting",error:g(U).username},null,8,["modelValue","error"])]),p("div",E,[h(s,{modelValue:g(k).email,"onUpdate:modelValue":a[1]||(a[1]=e=>g(k).email=e),label:"Email",placeholder:"Email manzilingizni kiriting",error:g(U).email},null,8,["modelValue","error"])]),p("div",A,[h(s,{modelValue:g(k).last_name,"onUpdate:modelValue":a[2]||(a[2]=e=>g(k).last_name=e),label:"Familiya",placeholder:"Familiyangizni kiriting",error:g(U).last_name},null,8,["modelValue","error"])]),p("div",D,[h(s,{modelValue:g(k).first_name,"onUpdate:modelValue":a[3]||(a[3]=e=>g(k).first_name=e),label:"Ismingiz",placeholder:"Ismingizni kiriting",error:g(U).first_name},null,8,["modelValue","error"])]),p("div",N,[h(s,{modelValue:g(k).father_name,"onUpdate:modelValue":a[4]||(a[4]=e=>g(k).father_name=e),label:"Otasining ismi",placeholder:"Otasining ismini kiriting",error:g(U).father_name},null,8,["modelValue","error"])]),p("div",Q,[h(r,{modelValue:g(k).department_id,"onUpdate:modelValue":a[5]||(a[5]=e=>g(k).department_id=e),label:"Bo‘lim",options:g(o).departments,"option-label":"name","option-value":"id",placeholder:"Bo‘lim kiriting",error:g(U).department_id},null,8,["modelValue","options","error"])]),p("div",H,[h(s,{modelValue:g(k).position,"onUpdate:modelValue":a[6]||(a[6]=e=>g(k).position=e),label:"Lavozim",placeholder:"Lavozim kiriting",error:g(U).position},null,8,["modelValue","error"])]),p("div",R,[h(s,{modelValue:g(k).password,"onUpdate:modelValue":a[7]||(a[7]=e=>g(k).password=e),type:"password",label:"Parol",placeholder:"Parolni yangilamoqchi bo‘lsangiz kiriting",error:g(U).password},null,8,["modelValue","error"])])]),p("div",X,[h(l,{variant:"ghost",type:"button",onClick:C,disabled:g(i).loading},{default:f(()=>[...a[8]||(a[8]=[b("Bekor qilish",-1)])]),_:1},8,["disabled"]),h(l,{type:"submit",variant:"primary",loading:g(i).loading,disabled:g(i).loading},{default:f(()=>[b(x(g(i).loading?"Yuborilmoqda...":d.value?"Yangilash":"Saqlash"),1)]),_:1},8,["loading","disabled"])])],32)])}}},J={class:"flex flex-row items-end py-4 justify-between"},K={class:"flex items-center w-1/2 justify-end gap-4"},W={class:"table-header flex gap-3 items-center"},Z=["src"],$={class:"table-header"},ee={class:"px-4 py-3 whitespace-nowrap"},ae={class:"table-header"},le={class:"table-header"},se={class:"table-header flex flex-row items-start"},re={class:"p-4 sticky bottom-0"},ie={__name:"UserList",setup(a){const t=e(),v=l(),_=w(""),F={admin:"bg-red-100 text-red-700 border-red-200",devonxona:"bg-amber-100 text-amber-700 border-amber-200",user:"bg-emerald-100 text-emerald-700 border-emerald-200",default:"bg-gray-100 text-gray-700 border-gray-200"},q=()=>{t.searchQuery=_.value,t.fetchUsers(1)},I=()=>{_.value="",t.searchQuery="",t.fetchUsers(1)},z=e=>t.fetchUsers(e);y(()=>{t.fetchUsers()});return(e,a)=>{const l=u("UInput"),y=u("UButton");return c(),m(k,null,[p("div",J,[h(l,{label:"",type:"text",modelValue:_.value,"onUpdate:modelValue":a[0]||(a[0]=e=>_.value=e),placeholder:"Foydalanuvchi qidirish uchun ism familiya va otasining ismi kiriting..."},{right:f(()=>[h(g(o),{class:"text-gray-300"})]),_:1},8,["modelValue"]),p("div",K,[h(y,{variant:"hover",onClick:I},{default:f(()=>[h(g(n),{class:"w-5 h-5 text-gray-400"})]),_:1}),h(y,{variant:"primary",onClick:q},{default:f(()=>[...a[1]||(a[1]=[b("Qidirish",-1)])]),_:1})])]),h(r,null,{thead:f(()=>[...a[2]||(a[2]=[p("th",{class:"table-header uppercase"},"Foydalanuvchi",-1),p("th",{class:"table-header uppercase"},"Isim Familiyasi Otasining ismi",-1),p("th",{class:"table-header uppercase"},"Role",-1),p("th",{class:"table-header uppercase"},"Bo‘lim",-1),p("th",{class:"table-header uppercase"},"Yaratilgan sana",-1),p("th",{class:"table-header uppercase"},"Tahrirlash",-1)])]),tbody:f(()=>[(c(!0),m(k,null,U(g(t).users,e=>(c(),m("tr",{key:e.id,class:"hover:bg-[#F4F6FC] divide-x"},[p("td",W,[p("img",{src:e.avatar||g(C),class:"w-10 h-10 rounded-full"},null,8,Z),p("div",null,[p("div",null,x(e.username),1)])]),p("td",$,x(e.last_name)+" "+x(e.first_name)+" "+x(e.father_name),1),p("td",ee,[e.groups?.[0]?(c(),m("span",{key:0,class:j(["px-2.5 py-0.5 rounded-full text-xs font-medium border",F[e.groups[0].toLowerCase()]||F.default])},x(e.groups[0]),3)):V("",!0)]),p("td",ae,x(e.department?.name),1),p("td",le,x(g(s)(e.created_at).format("DD MMMM YYYY")),1),p("td",se,[h(y,{variant:"hover",onClick:a=>((e=null)=>v.open(G,{userId:e}))(e.id)},{default:f(()=>[h(g(d),{class:"w-5 h-5"})]),_:1},8,["onClick"]),h(y,{variant:"hover",onClick:a=>{return l=e.id,v.open(S,{userId:l});var l}},{default:f(()=>[h(g(n),{class:"w-5 h-5 text-red-500"})]),_:1},8,["onClick"])])]))),128))]),pagination:f(()=>[p("div",re,[h(i,{currentPage:g(t).pagination.currentPage,previous:g(t).pagination.previous,next:g(t).pagination.next,lastPage:Math.ceil(g(t).pagination.count/10),total:g(t).pagination.count,loading:g(t).loading,onChange:z},null,8,["currentPage","previous","next","lastPage","total","loading"])])]),_:1})],64)}}},te={class:"overflow-y-auto h-screen"},oe={class:"flex flex-col gap-2 items-center p-2"},ne={class:"flex flex-col p-6 w-full"},de={__name:"UserViews",setup(e){const a=l();function s(){a.open(G)}return(e,a)=>(c(),m("div",te,[p("div",oe,[h(I,{title:"Tizim foydalanuvchilari",buttonText:"Foydalanuvchi qo‘shish",onAddNew:s}),p("div",ne,[h(ie),a[0]||(a[0]=p("div",{class:"w-full h-40"},null,-1))])])]))}};export{de as default};
