import{d as a,B as t,c as s,o as e,e as i,b as r,t as l,w as o,u as n,O as d,x as c}from"./vue-vendor-D8IdSx1h.js";import{h,b as u,u as f}from"./index-Bbk9u_eB.js";import{u as g}from"./useFormValidate-WCLlqkIO.js";import{X as m}from"./ui-vendor-Dpi5LIj3.js";const p=a("organizations",{state:()=>({organizations:[],selectedOrganizations:null,loading:!1,error:null}),actions:{async fetchAll(){this.loading=!0,this.error=null;try{const a=await h.get("/senders/");this.organizations=a.data||[]}catch(a){this.error=a}finally{this.loading=!1}},async fetchOne(a){this.loading=!0,this.error=null;try{const t=await(a=>h.get(`/senders/${a}/`))(a);this.selectedOrganizations=t.data||null}catch(t){this.error=t}finally{this.loading=!1}},async create(a){this.loading=!0,this.error=null;try{await(a=>h.post("/senders/",a))(a),await this.fetchAll()}catch(t){this.error=t}finally{this.loading=!1}},async update(a,t){this.loading=!0,this.error=null;try{await((a,t)=>h.put(`/senders/${a}/`,t))(a,t),await this.fetchAll()}catch(s){this.error=s}finally{this.loading=!1}},async remove(a){this.loading=!0,this.error=null;try{await(a=>h.delete(`/senders/${a}/`))(a),this.organizations=this.organizations.filter(t=>t.id!==a)}catch(t){this.error=t}finally{this.loading=!1}}}}),y={class:"flex flex-col w-[700px]"},w={class:"flex justify-between modal-border items-center p-[14px] border-b"},b={class:"text-gray-600 text-lg font-bold uppercase"},x={class:"flex flex-wrap -mx-2 p-4"},v={class:"w-full px-2 py-2"},z={class:"justify-end border-t modal-card modal-border flex items-center p-4"},k={__name:"OrganizationForm",props:{id:{type:Number,default:null}},setup(a){const h=p(),k=u(),j=f(),{form:_,errors:q,validate:O,resetForm:V}=g({name:""},{name:{required:!0,message:"Majburiy"}}),A=a,B=!!A.id,C=async()=>{if(O())try{B?(await h.update(A.id,_),j.show("Muvaffaqiyatli yangilandi","success")):(await h.create(_),j.show("Muvaffaqiyatli yaratildi","success")),F(),V()}catch(a){j.show("Xatolik yuz berdi","")}},F=()=>k.close();return(a,u)=>{const f=t("UButton"),g=t("UInput");return e(),s("div",y,[i("div",w,[i("p",b,l(B?"Yangilash":"Yangi"),1),r(f,{customClass:"bg-gray-300 rounded-full p-1",onClick:F},{default:o(()=>[r(n(m),{"stroke-width":"3",class:"w-4 h-4 text-white"})]),_:1})]),i("form",{onSubmit:c(C,["prevent"]),class:"space-y-6"},[i("div",x,[i("div",v,[r(g,{modelValue:n(_).name,"onUpdate:modelValue":u[0]||(u[0]=a=>n(_).name=a),label:"Tashkelot",placeholder:"Tashkilot kiriting",error:n(q).name},null,8,["modelValue","error"])])]),i("div",z,[r(f,{type:"button",variant:"ghost",onClick:F,disabled:n(h).loading},{default:o(()=>[...u[1]||(u[1]=[d("Bekor qilish",-1)])]),_:1},8,["disabled"]),r(f,{type:"submit",variant:"primary",loading:n(h).loading},{default:o(()=>[d(l(B?"Yangilash":"Saqlash"),1)]),_:1},8,["loading"])])],32)])}}};export{k as _,p as u};
