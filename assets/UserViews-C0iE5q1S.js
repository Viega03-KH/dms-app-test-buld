import{u as S}from"./usersStore-C8JwYI1T.js";import{u as F,x as k,r as b,a as w,o as x,b as t,g as a,h as p,f as e,j as U,O as D,y as M,d as T,l as q,v as _,w as E,Q as L,c as Y,J as N,K as O,L as R}from"./index-CLFv_Ssa.js";import{B as A,I as X}from"./IconBG-Dwxa_np9.js";import{_ as G}from"./UPagination-CmtPXPhn.js";import{X as C,u as J}from"./useFormValidate-Dl-5tU3h.js";import{u as K}from"./departmentStore-BSxdtMu8.js";import{u as Q}from"./user-BRUuMk4P.js";import{S as H}from"./square-pen-DqC3IW3m.js";import{T as W}from"./trash-2-Djc1Xy6H.js";import{P as Z}from"./plus-C8rSrBAw.js";import"./chevron-left-mvTBqVOE.js";import"./chevron-right-BJZ3BHcr.js";const ee={class:"max-w-xl max-h-xl"},te={class:"flex justify-between modal-border items-center p-[14px] border-b"},se={class:"justify-end border-t modal-card flex gap-2 p-4"},ae={__name:"UserDelete",props:{userId:{type:Number,required:!0}},setup(f){const u=f,n=S(),h=F(),d=k(),g=async()=>{try{await n.removeUser(u.userId),h.show("Foydalanuvchi muvaffaqiyatli o‘chirildi!","success"),d.close()}catch(c){h.show("Xatolik yuz berdi!","error"),console.error(c)}};return(c,i)=>{const s=b("UButton");return x(),w("div",ee,[t("div",te,[i[2]||(i[2]=t("p",{class:"text-dark text-lg font-semibold"},"Foydalanuvchini o‘chirish",-1)),a(s,{customClass:"bg-[#475467] rounded-full p-1",onClick:i[0]||(i[0]=o=>e(d).close())},{default:p(()=>[a(e(C),{"stroke-width":"3",class:"w-4 h-4 text-white"})]),_:1})]),i[5]||(i[5]=t("div",{class:"p-4 text-center space-y-4"},[t("p",{class:"text-base text-dark"}," Siz rostdan ham bu foydalanuvchini o‘chirmoqchimisiz? ")],-1)),t("div",se,[a(s,{variant:"ghost",onClick:i[1]||(i[1]=o=>e(d).close()),disabled:e(n).loading},{default:p(()=>[...i[3]||(i[3]=[U(" Bekor qilish ",-1)])]),_:1},8,["disabled"]),a(s,{variant:"danger",onClick:g,loading:e(n).loading},{default:p(()=>[...i[4]||(i[4]=[U(" O‘chirish ",-1)])]),_:1},8,["loading"])])])}}},oe=()=>D.get("/roles_list"),le=M("rolls",{state:()=>({rolls:[],selectedRoll:null,loading:!1,error:null}),actions:{async fetchAll(){try{this.loading=!0;const f=await oe();this.rolls=f.data}catch(f){this.error=f,console.error("Rolllarni olishda xato:",f)}finally{this.loading=!1}}}}),re={class:"flex flex-col max-w-2xl"},ie={class:"flex justify-between modal-border items-center p-[14px] border-b"},ne={class:"text-black text-md font-bold uppercase"},de={class:"flex flex-wrap -mx-2 p-4"},me={class:"w-full px-2 py-2 xl:w-1/2"},ue={class:"w-full px-2 py-2 xl:w-1/2"},ce={class:"w-full px-2 py-2 xl:w-1/2"},pe={class:"w-full px-2 py-2 xl:w-1/2"},fe={class:"w-full px-2 py-2 xl:w-1/2"},he={class:"w-full px-2 py-2 xl:w-1/2"},_e={class:"w-full px-2 py-2 xl:w-1/2"},ge={class:"w-full px-2 py-2 xl:w-1/2"},ve={class:"justify-end border-t modal-card modal-border flex items-center p-4"},j={__name:"UserForm",props:{userId:{type:Number,default:null}},setup(f){const u=f,n=S();le();const h=K(),d=F(),g=k(),c={id:"",username:"",email:"",last_name:"",first_name:"",father_name:"",position:"",department_id:"",password:""},i={username:{required:!0,message:"Ism majburiy"},email:{required:!0,message:"Email majburiy"},last_name:{required:!0,message:"Familiya majburiy"},first_name:{required:!0,message:"Sharif majburiy"},father_name:{required:!0,message:"Otasining ismi majburiy"},position:{required:!0,message:"Lavozim majburiy"},department_id:{required:!0,message:"Bo‘lim majburiy"},password:{required:!0,message:"Parol majburiy"}},{form:s,errors:o,validate:V,resetForm:z}=J(c,i),y=T(!1);q(async()=>{if(h.departments.length||await h.fetchAll(),u.userId){y.value=!0,await n.fetchUser(u.userId);const l=n.selectedUser;l&&(s.username=l.username,s.last_name=l.last_name,s.first_name=l.first_name,s.father_name=l.father_name,s.position=l.position,s.email=l.email,s.department_id=l.department?.id)}});const $=()=>{z(),g.close()},I=async()=>{if(V())try{const l={...s};y.value||delete l.id,l.password||delete l.password,y.value?await n.editUser(u.userId,l):await n.addUser(l),$(),d.show("Barchasi muvaffaqiyatli!","success")}catch(l){d.show(l?.response?.data?.message||"Xatolik yuz berdi","error"),console.error(l)}};return(l,r)=>{const B=b("UButton"),v=b("UInput"),P=b("USelect");return x(),w("div",re,[t("div",ie,[t("p",ne,_(y.value?"Foydalanuvchini tahrirlash":"Foydalanuvchi qo‘shish"),1),a(B,{customClass:"bg-[#475467] rounded-full p-1",onClick:$},{default:p(()=>[a(e(C),{"stroke-width":"3",class:"w-4 h-4 text-white"})]),_:1})]),t("form",{onSubmit:E(I,["prevent"]),class:"space-y-6"},[t("div",de,[t("div",me,[a(v,{modelValue:e(s).username,"onUpdate:modelValue":r[0]||(r[0]=m=>e(s).username=m),label:"Foydalanuvchi nomi",placeholder:"Foydalanuvchi nomini kiriting",error:e(o).name},null,8,["modelValue","error"])]),t("div",ue,[a(v,{modelValue:e(s).email,"onUpdate:modelValue":r[1]||(r[1]=m=>e(s).email=m),label:"Email",placeholder:"Email manzilingizni kiriting",error:e(o).email},null,8,["modelValue","error"])]),t("div",ce,[a(v,{modelValue:e(s).last_name,"onUpdate:modelValue":r[2]||(r[2]=m=>e(s).last_name=m),label:"Familiya",placeholder:"Familiyangizni kiriting",error:e(o).lastname},null,8,["modelValue","error"])]),t("div",pe,[a(v,{modelValue:e(s).first_name,"onUpdate:modelValue":r[3]||(r[3]=m=>e(s).first_name=m),label:"Ismingiz",placeholder:"Ismingizni kiriting",error:e(o).firstname},null,8,["modelValue","error"])]),t("div",fe,[a(v,{modelValue:e(s).father_name,"onUpdate:modelValue":r[4]||(r[4]=m=>e(s).father_name=m),label:"Otasining ismi",placeholder:"Otasining ismini kiriting",error:e(o).firstname},null,8,["modelValue","error"])]),t("div",he,[a(P,{modelValue:e(s).department_id,"onUpdate:modelValue":r[5]||(r[5]=m=>e(s).department_id=m),label:"Bo‘lim",options:e(h).departments,"option-label":"name","option-value":"id",placeholder:"Bo‘lim kiriting",error:e(o).department_id},null,8,["modelValue","options","error"])]),t("div",_e,[a(v,{modelValue:e(s).position,"onUpdate:modelValue":r[6]||(r[6]=m=>e(s).position=m),label:"Lavozim",placeholder:"Lavozim kiriting",error:e(o).firstname},null,8,["modelValue","error"])]),t("div",ge,[a(v,{modelValue:e(s).password,"onUpdate:modelValue":r[7]||(r[7]=m=>e(s).password=m),type:"password",label:"Parol",placeholder:"Parolni yangilamoqchi bo‘lsangiz kiriting",error:e(o).password},null,8,["modelValue","error"])])]),t("div",ve,[a(B,{variant:"ghost",type:"button",onClick:$,disabled:e(n).loading},{default:p(()=>[...r[8]||(r[8]=[U(" Bekor qilish ",-1)])]),_:1},8,["disabled"]),a(B,{type:"submit",variant:"primary",loading:e(n).loading},{default:p(()=>[U(_(y.value?"Yangilash":"Saqlash"),1)]),_:1},8,["loading"])])],32)])}}},be={class:"table-header"},xe={class:"table-header flex gap-3"},ye=["src"],we={class:"text-sm text-gray-500"},Ue={class:"table-header"},ke={class:"bg-blue-500 text-white px-2 rounded"},Ve={class:"table-header"},$e={class:"table-header"},Be={class:"table-header"},Se={__name:"UserList",setup(f){const u=S(),n=k();L();const h=c=>u.fetchUsers(c);q(()=>{u.fetchUsers()});const d=c=>n.open(ae,{userId:c}),g=(c=null)=>n.open(j,{userId:c});return(c,i)=>{const s=b("UButton");return x(),Y(A,null,{thead:p(()=>[...i[0]||(i[0]=[t("th",{class:"table-header uppercase"},"ID",-1),t("th",{class:"table-header uppercase"},"Foydalanuvchi",-1),t("th",{class:"table-header uppercase"},"Role",-1),t("th",{class:"table-header uppercase"},"Bo‘lim",-1),t("th",{class:"table-header uppercase"},"Yaratilgan sana",-1),t("th",{class:"table-header uppercase"},"Tahrirlash",-1)])]),tbody:p(()=>[(x(!0),w(N,null,O(e(u).users,o=>(x(),w("tr",{key:o.id,class:"hover:bg-[#F4F6FC]"},[t("td",be,"ID-"+_(o.id),1),t("td",xe,[t("img",{src:o.avatar||e(Q),class:"w-10 h-10 rounded-full"},null,8,ye),t("div",null,[t("div",null,_(o.username),1),t("div",we,_(o.email),1)])]),t("td",Ue,[t("span",ke,_(o.groups?.[0]),1)]),t("td",Ve,_(o.department?.name),1),t("td",$e,_(e(R)(o.created_at).format("DD MMMM YYYY")),1),t("td",Be,[a(s,{variant:"hover",onClick:V=>g(o.id)},{default:p(()=>[a(e(H),{class:"w-5 h-5"})]),_:1},8,["onClick"]),a(s,{variant:"hover",onClick:V=>d(o.id)},{default:p(()=>[a(e(W),{class:"w-5 h-5 text-red-500"})]),_:1},8,["onClick"])])]))),128))]),pagination:p(()=>[a(G,{total:e(u).pagination.count,currentPage:e(u).pagination.previous,lastPage:e(u).pagination.next,onChange:h},null,8,["total","currentPage","lastPage"])]),_:1})}}},Fe={class:"overflow-y-scroll h-screen"},qe={class:"flex flex-col items-center"},Ce={class:"relative flex bg-[#0F172A] shadow-sm flex-col gap-5 sm:flex-row sm:items-center sm:justify-between p-6 w-full overflow-hidden"},je={class:"flex py-4"},Ae={__name:"UserViews",setup(f){const u=k();function n(){u.open(j)}return(h,d)=>{const g=b("UButton");return x(),w("div",Fe,[t("div",qe,[t("div",Ce,[a(X),d[2]||(d[2]=t("h3",{class:"text-md font-extrabold uppercase text-gray-100"}," Tizim foydalanuvchilari ",-1)),a(g,{class:"z-10",variant:"primary",onClick:d[0]||(d[0]=c=>n())},{default:p(()=>[a(e(Z),{"stroke-width":"3"}),d[1]||(d[1]=t("span",{class:"px-1"},"Foydalanuvchi qo‘shish",-1))]),_:1})]),t("div",je,[a(Se)])])])}}};export{Ae as default};
