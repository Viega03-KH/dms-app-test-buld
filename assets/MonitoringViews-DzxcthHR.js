import{_ as P,d as k,l as D,a as r,b as t,J as b,K as _,g as u,f as l,r as C,h as m,q as h,o as d,j as w,v as n,n as f,L as j,w as S}from"./index-CkYps7b0.js";import{u as q}from"./taskStore-Cb8yVsbe.js";import{_ as z}from"./UPagination-qi9DYPP6.js";import{T as U}from"./trash-2-DzZfIUqq.js";import"./chevron-left-B45wgM8k.js";import"./chevron-right-BmSC8-ia.js";const A={class:"overflow-y-scroll h-screen"},N={class:"w-full max-w-[1400px] mx-auto px-4 py-6 flex flex-col gap-6 flex-grow"},R={class:"bg-white p-4 rounded-xl border border-slate-200 shadow-sm flex flex-col lg:flex-row items-center justify-between gap-4 shrink-0"},$={class:"flex items-center gap-1 bg-slate-100 p-1 rounded-lg w-full lg:w-auto overflow-x-auto no-scrollbar"},I={class:"ml-1 text-[10px] font-normal opacity-60"},J={class:"flex items-center gap-3 w-full lg:w-auto"},E={class:"bg-white rounded-xl shadow-sm border border-slate-200 flex flex-col overflow-hidden"},F={class:"overflow-x-auto"},H={class:"w-full border-collapse"},L={key:0},K=["onClick"],O={class:"px-4 py-4 text-center text-sm text-slate-600 font-medium"},Q={class:"px-4 py-4"},G={class:"flex flex-col gap-0.5"},W={class:"text-sm font-bold text-slate-800"},X={class:"text-xs text-slate-400 truncate max-w-[350px]"},Z={class:"px-4 py-4 text-center"},tt={class:"text-xs font-bold px-2 py-1 rounded bg-orange-50 text-orange-600 border border-orange-100"},et={class:"px-4 py-4 text-sm font-medium text-slate-700"},st={class:"inline-flex items-center bg-slate-100 p-1 rounded-md border border-slate-200"},at=["onClick"],ot={key:0},lt={colspan:"5",class:"px-6 py-4 bg-slate-50/80 border-b"},nt={class:"bg-white p-5 rounded-lg border border-slate-200 shadow-sm grid grid-cols-1 md:grid-cols-2 gap-6 animate-in fade-in duration-300"},rt={class:"space-y-4"},dt={class:"text-sm font-bold text-slate-800 leading-snug"},it={class:"text-sm font-normal text-slate-600 italic leading-relaxed"},ct={class:"bg-blue-50/50 p-4 rounded-lg border border-blue-100"},ut={class:"text-sm font-bold text-slate-700"},pt={class:"mt-4 pt-3 border-t border-blue-100 text-[11px] font-medium text-slate-500 italic"},xt={key:0,class:"py-20 flex justify-center w-full"},bt={class:"px-6 py-4 bg-slate-50 flex items-center justify-between border-t border-slate-200 mt-auto"},ft={__name:"MonitoringViews",setup(gt){const s=q(),g=k("all"),p=k(null),M=[{id:"in_progress",name:"Jarayonda",color:"bg-blue-500"},{id:"done",name:"Bajarildi",color:"bg-green-500"},{id:"be_rejected",name:"Rad etildi",color:"bg-red-500"}],y=[{key:"all",label:"Barchasi",status:""},{key:"done",label:"Bajarilgan",status:"done"},{key:"in_progress",label:"Jarayonda",status:"in_progress"},{key:"be_rejected",label:"Rad etilgan",status:"be_rejected"}];y.forEach(o=>{o.count=()=>o.key==="all"?s.pagination.count||0:s[o.key]||0});const Y=o=>p.value=p.value===o?null:o,x=async()=>{p.value=null,await s.fetchAll(1)},T=async(o,a)=>{const c=s.tasks.find(e=>e.id===o);if(c&&c.status===a)return;(await s.updateTaskStatus(o,a)).success&&await s.fetchAll(s.pagination.currentPage)},V=async o=>{g.value=o.key,s.filters.status=o.status,await x()},B=async()=>{g.value="all",s.filters.due_date=null,s.filters.status="",await x()};return D(()=>s.fetchAll()),(o,a)=>{const c=C("UButton"),v=C("UDatePicker");return d(),r("div",A,[t("main",N,[t("section",R,[t("div",$,[(d(),r(b,null,_(y,e=>u(c,{key:e.key,onClick:i=>V(e),class:f(["flex-1 lg:flex-none px-4 py-2 rounded-md text-xs font-bold uppercase transition-all whitespace-nowrap",g.value===e.key?"bg-white shadow text-blue-600 ring-1 ring-slate-200":"text-slate-500 hover:text-slate-700"])},{default:m(()=>[w(n(e.label)+" ",1),t("span",I,"("+n(e.count())+")",1)]),_:2},1032,["onClick","class"])),64))]),t("div",J,[u(v,{modelValue:l(s).filters.due_date,"onUpdate:modelValue":[a[0]||(a[0]=e=>l(s).filters.due_date=e),x],placeholder:"Muddati",class:"flex-1 lg:w-48"},null,8,["modelValue"]),u(c,{variant:"primary",onClick:x,loading:l(s).loading},{default:m(()=>[...a[3]||(a[3]=[w(" Izlash ",-1)])]),_:1},8,["loading"]),u(c,{variant:"ghost",onClick:B,class:"h-10 w-10 flex items-center justify-center rounded-lg border border-slate-200 text-slate-400 hover:bg-red-50 hover:text-red-500 transition-all shadow-sm"},{default:m(()=>[u(l(U),{class:"w-4 h-4"})]),_:1})])]),t("div",E,[t("div",F,[t("table",H,[a[7]||(a[7]=t("thead",null,[t("tr",{class:"bg-slate-50 border-b border-slate-200 text-slate-500"},[t("th",{class:"w-[12%] px-4 py-4 text-xs font-bold uppercase text-center"},"Sana"),t("th",{class:"w-[38%] px-4 py-4 text-xs font-bold uppercase text-left"},"Hujjat"),t("th",{class:"w-[12%] px-4 py-4 text-xs font-bold uppercase text-center"},"Muddat"),t("th",{class:"w-[18%] px-4 py-4 text-xs font-bold uppercase text-left"},"Mas'ul"),t("th",{class:"w-[20%] px-4 py-4 text-xs font-bold uppercase text-center"},"Holat")])],-1)),l(s).loading?h("",!0):(d(),r("tbody",L,[(d(!0),r(b,null,_(l(s).tasks,e=>(d(),r(b,{key:e.id},[t("tr",{class:f(["group border-b border-slate-100 hover:bg-slate-50 transition-colors cursor-pointer",{"bg-blue-50/50":p.value===e.id}]),onClick:i=>Y(e.id)},[t("td",O,n(e.document?.created_at?l(j)(e.document.created_at).format("DD.MM.YYYY"):"--"),1),t("td",Q,[t("div",G,[t("span",W,"â„– "+n(e.document?.in_number||"---"),1),t("span",X,n(e.document?.title),1)])]),t("td",Z,[t("span",tt,n(e.due_date?l(j)(e.due_date).format("DD.MM.YYYY"):"--"),1)]),t("td",et,n(e.assignees?.[0]?.last_name||"---"),1),t("td",{class:"px-4 py-4 text-center",onClick:a[1]||(a[1]=S(()=>{},["stop"]))},[t("div",st,[(d(),r(b,null,_(M,i=>t("button",{key:i.id,onClick:_t=>T(e.id,i.id),class:f(["px-3 py-1.5 rounded text-[10px] font-bold flex items-center gap-1.5 transition-all",e.status===i.id?"bg-white shadow-sm text-blue-700 ring-1 ring-black/5":"text-slate-400 hover:text-slate-600"])},[t("span",{class:f(["w-1.5 h-1.5 rounded-full",i.color])},null,2),w(" "+n(i.name),1)],10,at)),64))])])],10,K),p.value===e.id?(d(),r("tr",ot,[t("td",lt,[t("div",nt,[t("div",rt,[t("div",null,[a[4]||(a[4]=t("p",{class:"text-[10px] font-bold text-blue-600 uppercase mb-1 tracking-widest"},"To'liq sarlavha ",-1)),t("p",dt,n(e.document?.title),1)]),t("div",null,[a[5]||(a[5]=t("p",{class:"text-[10px] font-bold text-slate-400 uppercase mb-1 tracking-widest"},"Qisqacha mazmun ",-1)),t("p",it,n(e.document?.summary||"Ma'lumot kiritilmagan"),1)])]),t("div",ct,[a[6]||(a[6]=t("p",{class:"text-[10px] font-bold text-blue-500 uppercase mb-2 tracking-widest"},"Topshiriq (Rezolyutsiya)",-1)),t("p",ut,n(e.description||"Izoh qoldirilmagan"),1),t("div",pt," Yuboruvchi: "+n(e.document?.sender?.name||"---"),1)])])])])):h("",!0)],64))),128))]))]),l(s).loading?(d(),r("div",xt,[...a[8]||(a[8]=[t("span",{class:"text-sm text-slate-400 animate-pulse"},"Yuklanmoqda...",-1)])])):h("",!0)]),t("footer",bt,[u(z,{total:l(s).pagination.count,currentPage:l(s).pagination.currentPage,lastPage:Math.ceil((l(s).pagination.count||0)/10),onChange:a[2]||(a[2]=e=>l(s).fetchAll(e))},null,8,["total","currentPage","lastPage"])])])])])}}},Ct=P(ft,[["__scopeId","data-v-f46ccb1e"]]);export{Ct as default};
