import{S as a,y as n,u as i}from"./index-CCDjh50H.js";const l=(s=1)=>{const t=Number(s)||1;return a.get(`/users?page=${t}`)},c=()=>a.get("/all"),h=s=>a.post("/users/",s),u=s=>a.get(`/users/${s}/`),d=(s,t)=>a.put(`/users/${s}/`,t),g=s=>a.delete(`/users/${s}/`),y=n("users",{state:()=>({users:[],pagination:{previous:1,next:1,count:0},selectedUser:null,loading:!1,error:null}),actions:{_handleError(s,t){const e=i(),r=s.response?.data?.message||t||"Xatolik yuz berdi";throw this.error=r,e.show(r,"error"),s},async fetchUsersNotPage(){this.loading=!0,this.error=null;try{const s=await c();this.users=s.data.data}catch(s){this._handleError(s,"Foydalanuvchilarni olishda xato")}finally{this.loading=!1}},async fetchUsers(s=null){this.loading=!0,this.error=null;try{const t=s||this.pagination.previous||1,e=await l(t);this.users=e.data.results,this.pagination.previous=e.data.previous,this.pagination.next=e.data.next,this.pagination.count=e.data.count}catch(t){this._handleError(t,"Ro'yxatni yuklashda xato")}finally{this.loading=!1}},async fetchUser(s){this.loading=!0;try{const t=await u(s);return this.selectedUser=t.data,t.data}catch(t){this._handleError(t,"Ma'lumotlarni yuklashda xato")}finally{this.loading=!1}},async addUser(s){this.loading=!0;const t=i();try{const e=await h(s);return await this.fetchUsers(),t.show("Muvaffaqiyatli qo'shildi!","success"),{success:!0,data:e.data}}catch(e){this.error=e.message;const r=e.response?.data?.message||"Qo'shib bo'lmadi";return t.show(r,"error"),{success:!1,error:r}}finally{this.loading=!1}},async editUser(s,t){this.loading=!0,this.error=null;const e=i();try{const r=await d(s,t);return await this.fetchUsers(),e.show("Muvaffaqiyatli yangilandi!","success"),{success:!0,data:r.data}}catch(r){const o=r.response?.data?.message||"Yangilashda xato";return this.error=o,e.show(o,"error"),{success:!1,error:o}}finally{this.loading=!1}},async removeUser(s){this.loading=!0;const t=i();try{await g(s),await this.fetchUsers(),t.show("Muvaffaqiyatli o'chirildi!","success")}catch(e){this._handleError(e,"O'chirishda xatolik")}finally{this.loading=!1}}}});export{y as u};
