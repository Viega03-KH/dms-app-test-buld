import{u as B}from"./usersStore-C95FDL8S.js";import{u as F,x as U,r as g,a as y,o as v,b as s,g as o,h as c,f as e,j as w,D as P,l as q,v as h,w as D,Q as M,c as T,J as Y,K as E,L}from"./index-C_K37xRx.js";import{B as N,I as O}from"./IconBG-BcW6UIG4.js";import{_ as A}from"./UPagination-HO_MprsD.js";import{X as S,u as X}from"./useFormValidate-BOioRNXX.js";import{u as G}from"./departmentStore-D5OxF0-C.js";import{u as J}from"./user-BRUuMk4P.js";import{S as K}from"./square-pen-CdGZNWcY.js";import{T as Q}from"./trash-2-DmzZRlEO.js";import{P as R}from"./plus-D3rnAYTi.js";import"./chevron-left-gwF59zbH.js";import"./chevron-right-CzYd6Vsm.js";const H={class:"max-w-xl max-h-xl"},W={class:"flex justify-between modal-border items-center p-[14px] border-b"},Z={class:"justify-end border-t modal-card flex gap-2 p-4"},ee={__name:"UserDelete",props:{userId:{type:Number,required:!0}},setup(x){const i=x,r=B(),_=F(),m=U(),f=async()=>{try{await r.removeUser(i.userId),_.show("Foydalanuvchi muvaffaqiyatli o‘chirildi!","success"),m.close()}catch(u){_.show("Xatolik yuz berdi!","error"),console.error(u)}};return(u,n)=>{const t=g("UButton");return v(),y("div",H,[s("div",W,[n[2]||(n[2]=s("p",{class:"text-dark text-lg font-semibold"},"Foydalanuvchini o‘chirish",-1)),o(t,{customClass:"bg-[#475467] rounded-full p-1",onClick:n[0]||(n[0]=l=>e(m).close())},{default:c(()=>[o(e(S),{"stroke-width":"3",class:"w-4 h-4 text-white"})]),_:1})]),n[5]||(n[5]=s("div",{class:"p-4 text-center space-y-4"},[s("p",{class:"text-base text-dark"}," Siz rostdan ham bu foydalanuvchini o‘chirmoqchimisiz? ")],-1)),s("div",Z,[o(t,{variant:"ghost",onClick:n[1]||(n[1]=l=>e(m).close()),disabled:e(r).loading},{default:c(()=>[...n[3]||(n[3]=[w(" Bekor qilish ",-1)])]),_:1},8,["disabled"]),o(t,{variant:"danger",onClick:f,loading:e(r).loading},{default:c(()=>[...n[4]||(n[4]=[w(" O‘chirish ",-1)])]),_:1},8,["loading"])])])}}},se={class:"flex flex-col max-w-2xl"},te={class:"flex justify-between modal-border items-center p-[14px] border-b"},ae={class:"text-black text-md font-bold uppercase"},oe={class:"flex flex-wrap -mx-2 p-4"},le={class:"w-full px-2 py-2 xl:w-1/2"},re={class:"w-full px-2 py-2 xl:w-1/2"},ie={class:"w-full px-2 py-2 xl:w-1/2"},ne={class:"w-full px-2 py-2 xl:w-1/2"},de={class:"w-full px-2 py-2 xl:w-1/2"},me={class:"w-full px-2 py-2 xl:w-1/2"},ue={class:"w-full px-2 py-2 xl:w-1/2"},pe={class:"w-full px-2 py-2 xl:w-1/2"},ce={class:"justify-end border-t modal-card modal-border flex items-center p-4 gap-2"},I={__name:"UserForm",props:{userId:{type:Number,default:null}},setup(x){const i=x,r=B(),_=G();F();const m=U(),f=P(()=>!!i.userId),u={id:"",username:"",email:"",last_name:"",first_name:"",father_name:"",position:"",department_id:"",password:""},n={username:{required:!0,message:"Ism majburiy"},email:{required:!0,message:"Email majburiy"},last_name:{required:!0,message:"Familiya majburiy"},first_name:{required:!0,message:"Sharif majburiy"},father_name:{required:!0,message:"Otasining ismi majburiy"},position:{required:!0,message:"Lavozim majburiy"},department_id:{required:!0,message:"Bo‘lim majburiy"},password:{required:!i.userId,message:"Parol majburiy"}},{form:t,errors:l,validate:k,resetForm:C}=X(u,n);q(async()=>{const p=[];if(_.departments.length||p.push(_.fetchAll()),i.userId&&p.push(r.fetchUser(i.userId)),await Promise.all(p),i.userId&&r.selectedUser){const a=r.selectedUser;t.username=a.username,t.last_name=a.last_name,t.first_name=a.first_name,t.father_name=a.father_name,t.position=a.position,t.email=a.email,t.department_id=a.department?.id}});const V=()=>{C(),m.close()},j=async()=>{if(!(!k()||r.loading))try{const p={...t};f.value||delete p.id,p.password||delete p.password,f.value?await r.editUser(i.userId,p):await r.addUser(p),V()}catch(p){console.error(p)}};return(p,a)=>{const $=g("UButton"),b=g("UInput"),z=g("USelect");return v(),y("div",se,[s("div",te,[s("p",ae,h(f.value?"Foydalanuvchini tahrirlash":"Foydalanuvchi qo‘shish"),1),o($,{customClass:"bg-[#475467] rounded-full p-1",onClick:V},{default:c(()=>[o(e(S),{"stroke-width":"3",class:"w-4 h-4 text-white"})]),_:1})]),s("form",{onSubmit:D(j,["prevent"]),class:"space-y-6"},[s("div",oe,[s("div",le,[o(b,{modelValue:e(t).username,"onUpdate:modelValue":a[0]||(a[0]=d=>e(t).username=d),label:"Foydalanuvchi nomi",placeholder:"Foydalanuvchi nomini kiriting",error:e(l).username},null,8,["modelValue","error"])]),s("div",re,[o(b,{modelValue:e(t).email,"onUpdate:modelValue":a[1]||(a[1]=d=>e(t).email=d),label:"Email",placeholder:"Email manzilingizni kiriting",error:e(l).email},null,8,["modelValue","error"])]),s("div",ie,[o(b,{modelValue:e(t).last_name,"onUpdate:modelValue":a[2]||(a[2]=d=>e(t).last_name=d),label:"Familiya",placeholder:"Familiyangizni kiriting",error:e(l).last_name},null,8,["modelValue","error"])]),s("div",ne,[o(b,{modelValue:e(t).first_name,"onUpdate:modelValue":a[3]||(a[3]=d=>e(t).first_name=d),label:"Ismingiz",placeholder:"Ismingizni kiriting",error:e(l).first_name},null,8,["modelValue","error"])]),s("div",de,[o(b,{modelValue:e(t).father_name,"onUpdate:modelValue":a[4]||(a[4]=d=>e(t).father_name=d),label:"Otasining ismi",placeholder:"Otasining ismini kiriting",error:e(l).father_name},null,8,["modelValue","error"])]),s("div",me,[o(z,{modelValue:e(t).department_id,"onUpdate:modelValue":a[5]||(a[5]=d=>e(t).department_id=d),label:"Bo‘lim",options:e(_).departments,"option-label":"name","option-value":"id",placeholder:"Bo‘lim kiriting",error:e(l).department_id},null,8,["modelValue","options","error"])]),s("div",ue,[o(b,{modelValue:e(t).position,"onUpdate:modelValue":a[6]||(a[6]=d=>e(t).position=d),label:"Lavozim",placeholder:"Lavozim kiriting",error:e(l).position},null,8,["modelValue","error"])]),s("div",pe,[o(b,{modelValue:e(t).password,"onUpdate:modelValue":a[7]||(a[7]=d=>e(t).password=d),type:"password",label:"Parol",placeholder:"Parolni yangilamoqchi bo‘lsangiz kiriting",error:e(l).password},null,8,["modelValue","error"])])]),s("div",ce,[o($,{variant:"ghost",type:"button",onClick:V,disabled:e(r).loading},{default:c(()=>[...a[8]||(a[8]=[w(" Bekor qilish ",-1)])]),_:1},8,["disabled"]),o($,{type:"submit",variant:"primary",loading:e(r).loading,disabled:e(r).loading},{default:c(()=>[w(h(e(r).loading?"Yuborilmoqda...":f.value?"Yangilash":"Saqlash"),1)]),_:1},8,["loading","disabled"])])],32)])}}},fe={class:"table-header"},_e={class:"table-header flex gap-3"},he=["src"],be={class:"text-sm text-gray-500"},ge={class:"table-header"},ve={class:"bg-blue-500 text-white px-2 rounded"},xe={class:"table-header"},ye={class:"table-header"},we={class:"table-header"},Ue={__name:"UserList",setup(x){const i=B(),r=U();M();const _=u=>i.fetchUsers(u);q(()=>{i.fetchUsers()});const m=u=>r.open(ee,{userId:u}),f=(u=null)=>r.open(I,{userId:u});return(u,n)=>{const t=g("UButton");return v(),T(N,null,{thead:c(()=>[...n[0]||(n[0]=[s("th",{class:"table-header uppercase"},"ID",-1),s("th",{class:"table-header uppercase"},"Foydalanuvchi",-1),s("th",{class:"table-header uppercase"},"Role",-1),s("th",{class:"table-header uppercase"},"Bo‘lim",-1),s("th",{class:"table-header uppercase"},"Yaratilgan sana",-1),s("th",{class:"table-header uppercase"},"Tahrirlash",-1)])]),tbody:c(()=>[(v(!0),y(Y,null,E(e(i).users,l=>(v(),y("tr",{key:l.id,class:"hover:bg-[#F4F6FC]"},[s("td",fe,"ID-"+h(l.id),1),s("td",_e,[s("img",{src:l.avatar||e(J),class:"w-10 h-10 rounded-full"},null,8,he),s("div",null,[s("div",null,h(l.username),1),s("div",be,h(l.email),1)])]),s("td",ge,[s("span",ve,h(l.groups?.[0]),1)]),s("td",xe,h(l.department?.name),1),s("td",ye,h(e(L)(l.created_at).format("DD MMMM YYYY")),1),s("td",we,[o(t,{variant:"hover",onClick:k=>f(l.id)},{default:c(()=>[o(e(K),{class:"w-5 h-5"})]),_:1},8,["onClick"]),o(t,{variant:"hover",onClick:k=>m(l.id)},{default:c(()=>[o(e(Q),{class:"w-5 h-5 text-red-500"})]),_:1},8,["onClick"])])]))),128))]),pagination:c(()=>[o(A,{total:e(i).pagination.count,currentPage:e(i).pagination.previous,lastPage:e(i).pagination.next,onChange:_},null,8,["total","currentPage","lastPage"])]),_:1})}}},ke={class:"overflow-y-scroll h-screen"},Ve={class:"flex flex-col items-center"},$e={class:"relative flex bg-[#0F172A] shadow-sm flex-col gap-5 sm:flex-row sm:items-center sm:justify-between p-6 w-full overflow-hidden"},Be={class:"flex py-4"},Ee={__name:"UserViews",setup(x){const i=U();function r(){i.open(I)}return(_,m)=>{const f=g("UButton");return v(),y("div",ke,[s("div",Ve,[s("div",$e,[o(O),m[2]||(m[2]=s("h3",{class:"text-md font-extrabold uppercase text-gray-100"}," Tizim foydalanuvchilari ",-1)),o(f,{class:"z-10",variant:"primary",onClick:m[0]||(m[0]=u=>r())},{default:c(()=>[o(e(R),{"stroke-width":"3"}),m[1]||(m[1]=s("span",{class:"px-1"},"Foydalanuvchi qo‘shish",-1))]),_:1})]),s("div",Be,[o(Ue)])])])}}};export{Ee as default};
