import{k as V,Q as K,D as T,L as Q,a as p,o as d,b as a,f as l,v as D,c as w,n as I,E as z,q as _,g as o,J as F,K as $,O,y as J,x as R,d as j,l as Y,h as v,R as k,j as P,A as X,t as W,U as G,S as E,s as Z}from"./index-C_K37xRx.js";import{_ as b,a as q,S as H}from"./UFileCard-BpX_92pW.js";import{u as B,_ as ee}from"./CreateDockForm-Dh4tbfeH.js";import{X as te}from"./useFormValidate-BOioRNXX.js";import{C as ae}from"./cloud-upload-DeU478jq.js";import{_ as se}from"./TaskForm-zEzLRw-U.js";import{_ as le}from"./UPagination-HO_MprsD.js";import{P as oe}from"./plus-D3rnAYTi.js";import{S as ne}from"./square-pen-CdGZNWcY.js";import{T as ie}from"./trash-2-DmzZRlEO.js";import"./OrganizationForm-RgmxKNoU.js";import"./doctypeStore-BhZjXW8z.js";import"./deliveryStore-BdLeCr95.js";import"./jurnalStore-8QOd6Zno.js";import"./taskStore-CeK3DC7n.js";import"./usersStore-C95FDL8S.js";import"./subjectStore-CROQczHv.js";import"./chevron-left-gwF59zbH.js";import"./chevron-right-CzYd6Vsm.js";/**
 * @license lucide-vue-next v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L=V("combine",[["path",{d:"M10 18H5a3 3 0 0 1-3-3v-1",key:"ru65g8"}],["path",{d:"M14 2a2 2 0 0 1 2 2v4a2 2 0 0 1-2 2",key:"e30een"}],["path",{d:"M20 2a2 2 0 0 1 2 2v4a2 2 0 0 1-2 2",key:"2ahx8o"}],["path",{d:"m7 21 3-3-3-3",key:"127cv2"}],["rect",{x:"14",y:"14",width:"8",height:"8",rx:"2",key:"1b0bso"}],["rect",{x:"2",y:"2",width:"8",height:"8",rx:"2",key:"1x09vl"}]]);/**
 * @license lucide-vue-next v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U=V("file-input",[["path",{d:"M4 22h14a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v4",key:"1pf5j1"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M2 15h10",key:"jfw4w8"}],["path",{d:"m9 18 3-3-3-3",key:"112psh"}]]);/**
 * @license lucide-vue-next v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const re=V("notepad-text-dashed",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v2",key:"j91f56"}],["path",{d:"M20 12v2",key:"w8o0tu"}],["path",{d:"M20 18v2a2 2 0 0 1-2 2h-1",key:"1c9ggx"}],["path",{d:"M13 22h-2",key:"191ugt"}],["path",{d:"M7 22H6a2 2 0 0 1-2-2v-2",key:"1rt9px"}],["path",{d:"M4 14v-2",key:"1v0sqh"}],["path",{d:"M4 8V6a2 2 0 0 1 2-2h2",key:"1mwabg"}],["path",{d:"M8 10h6",key:"3oa6kw"}],["path",{d:"M8 14h8",key:"1fgep2"}],["path",{d:"M8 18h5",key:"17enja"}]]),de={class:"flex flex-row"},ce={class:"flex-1 min-w-0"},ue={class:"flex items-center justify-between"},me={class:"flex flex-col py-2"},pe={class:"flex items-center justify-between"},fe={class:"flex-1 min-w-0 py-1 text-sm font-medium text-[#697696] line-clamp-2"},he="task card-dark border-b px-3 py-4 cursor-pointer hover:bg-[#4076FF0D]",ve={__name:"DockListItem",props:{dock:{type:Object,required:!0},active:{type:Boolean,default:!1}},setup(s){const e=K(),n=(y,i)=>{e.open(y,{x:i.clientX+10,y:i.clientY+10})},f=s,x=T(()=>Q(f.dock.doc_date).format("DD MMMM YYYY")),u={attached:{name:"Asosiy file mavjud",icon:L,color:"text-green-500"},draft:{name:"File mavjud emas.",icon:re,color:"text-yellow-500"}},h=T(()=>u[f.dock.status]||{name:"Noma'lum",icon:L,color:"text-gray-500"});return(y,i)=>(d(),p("div",{onClick:i[6]||(i[6]=m=>y.$emit("select",s.dock)),class:I([he,s.active?"bg-[#4076FF0D]":""])},[a("div",de,[a("div",ce,[a("div",ue,[a("h4",{onMouseenter:i[0]||(i[0]=m=>n("Kiruvchi raqam",m)),onMouseleave:i[1]||(i[1]=m=>l(e).close()),class:"text-sm font-extrabold text-black"},D(s.dock.in_number),33),a("h4",{onMouseenter:i[2]||(i[2]=m=>n("Ro`yxarga olingan sana",m)),onMouseleave:i[3]||(i[3]=m=>l(e).close()),class:"text-sm font-medium text-[#697696]"},D(x.value),33)]),a("div",me,[a("div",pe,[i[7]||(i[7]=a("span",{class:"flex-1 min-w-0 truncate text-sm font-bold text-black"}," Kiruvchi hujjat ",-1)),(d(),w(z(h.value.icon),{class:I(["w-5 h-5",h.value.color]),onMouseenter:i[4]||(i[4]=m=>n(h.value.name,m)),onMouseleave:i[5]||(i[5]=m=>l(e).close())},null,40,["class"]))]),a("span",fe,D(s.dock.summary),1)])])])],2))}},ke={key:0},ye={class:"grid grid-cols-1 md:grid-cols-2 gap-4 pb-4"},xe={key:0},ge={class:"grid grid-cols-2 gap-2"},be={__name:"DockShowItem",props:{dockfile:{type:Object,default:null}},setup(s){return(e,n)=>s.dockfile?(d(),p("div",ke,[a("div",ye,[o(b,{label:"Kelib tushgan raqam",value:s.dockfile.in_number},null,8,["value"]),o(b,{label:"Chiqish raqami",value:s.dockfile.out_number},null,8,["value"]),o(b,{label:"Hujjat nomi",value:s.dockfile.title,class:"md:col-span-2"},null,8,["value"]),o(b,{label:"Qisqa mazmun",value:s.dockfile.summary,class:"md:col-span-2"},null,8,["value"]),o(b,{label:"Tashkilot",value:s.dockfile.sender?.name},null,8,["value"]),o(b,{label:"Hujjat turi",value:s.dockfile.document_type?.name},null,8,["value"]),o(b,{label:"Yetkazib berish usuli",value:s.dockfile.delivery_type?.name},null,8,["value"]),o(b,{label:"Jurnal",value:s.dockfile.journal.name},null,8,["value"])]),s.dockfile.attachments?.length?(d(),p("div",xe,[n[0]||(n[0]=a("h3",{class:"font-semibold mb-2"},"Fayllar:",-1)),a("div",ge,[(d(!0),p(F,null,$(s.dockfile.attachments,f=>(d(),w(q,{key:f.id,file:f},null,8,["file"]))),128))])])):_("",!0)])):_("",!0)}},we=async({documentId:s,files:e})=>{if(!s)throw new Error("documentId is required");const n=new FormData;(Array.isArray(e)?e:[e]).forEach(u=>n.append("files",u)),n.append("document_id",s);const{data:x}=await O.post("/attachments/",n);return x},De=s=>O.delete(`/attachments/${s}/`),_e=J("attachment",{state:()=>({attachments:[],loading:!1}),actions:{async uploadFiles(s,e){if(!(!s||!e)){this.loading=!0;try{const n=await we({documentId:s,files:e});return Array.isArray(n)&&n.length>0&&this.attachments.push(...n),n}catch(n){throw console.error("Attachment upload failed in store:",n),n}finally{this.loading=!1}}},async deleteAttachment(s){if(s){this.loading=!0;try{await De(s),this.attachments=this.attachments.filter(e=>e.id!==s)}catch(e){throw console.error("Attachment delete failed in store:",e),e}finally{this.loading=!1}}},setAttachments(s){Array.isArray(s)&&(this.attachments=s)}}}),je={class:"w-[40vw] md:w-[40vw] 2xl:w-[40vw] h-auto flex flex-col"},Fe={class:"flex justify-between modal-border items-center p-[14px] border-b"},$e={class:"p-6 w-full h-full pb-10 overflow-y-scroll space-y-6"},Me={class:"flex flex-col gap-2"},Ce={key:0,class:"text-red-500 text-sm"},Ae={key:1,class:"space-y-2 mt-2"},Se={key:2,class:"space-y-2 mt-2"},qe={class:"flex justify-end gap-3 p-4 border-t modal-border"},N={__name:"CreateFileForm",props:{fileID:{type:Number,required:!1},file:{type:Object,required:!1}},setup(s){const e=s,n=R(),f=_e(),x=B(),u=j([]),h=j([]),y=j(!1),i=j({});Y(()=>{e.file?.attachments?.length&&(h.value=[...e.file.attachments],f.setAttachments([...e.file.attachments]))});function m(){u.value=[],n.close()}function M(t){u.value.splice(t,1)}function C(t){f.deleteAttachment(t),h.value=h.value.filter(c=>c.id!==t)}function A(t){const c=Array.from(t.target.files);if(!c.length)return;const r=c.map(S=>Object.assign(S,{isLocal:!0}));u.value.push(...r),t.target.value=""}async function g(){if(!u.value.length&&!h.value.length){i.value.files="Iltimos, fayl tanlang";return}i.value.files=null,y.value=!0;try{if(u.value.length){const t=e.fileID||e.file?.id;if(!t)throw new Error("Document ID mavjud emas");await f.uploadFiles(t,u.value),x.fetchAll(),u.value=[]}(e.fileID||e.file?.id)&&x.fetchAll(),n.close()}catch(t){console.error("Fayl upload xatosi:",t)}finally{y.value=!1}}return(t,c)=>(d(),p("div",je,[a("div",Fe,[c[3]||(c[3]=a("p",{class:"text-black text-md font-bold uppercase"},"Fayl qo'shish",-1)),o(k,{customClass:"bg-[#475467] rounded-full p-1",onClick:m},{default:v(()=>[o(l(te),{"stroke-width":"3",class:"w-3 h-3 text-white"})]),_:1})]),a("div",$e,[a("div",Me,[a("div",{class:"flex flex-col border border-[#EAECF0] shadow-sm rounded-[12px] items-center text-center justify-center p-6 cursor-pointer hover:border-blue-400 transition-colors",onDrop:c[0]||(c[0]=(...r)=>t.onDrop&&t.onDrop(...r)),onDragover:c[1]||(c[1]=(...r)=>t.onDragOver&&t.onDragOver(...r)),onClick:c[2]||(c[2]=r=>t.$refs.fileInput.click())},[o(l(ae),{"stroke-width":"1",class:"w-10 h-10 text-gray-400"}),c[4]||(c[4]=a("p",{class:"text-gray-500 py-2"},"Fayllarni bu yerga torting yoki tanlang",-1)),a("input",{ref:"fileInput",type:"file",class:"hidden",multiple:!0,accept:".pdf,.docx,.jpg,.png",onChange:A},null,544)],32),i.value.files?(d(),p("p",Ce,D(i.value.files),1)):_("",!0),u.value.length?(d(),p("div",Ae,[(d(!0),p(F,null,$(u.value,(r,S)=>(d(),w(q,{key:r.name,file:r,"show-delete":!0,onRemove:()=>M(S)},null,8,["file","onRemove"]))),128))])):_("",!0),h.value.length?(d(),p("div",Se,[(d(!0),p(F,null,$(h.value,r=>(d(),w(q,{key:r.id,file:r,"show-delete":!0,onRemove:()=>C(r.id)},null,8,["file","onRemove"]))),128))])):_("",!0)])]),a("div",qe,[o(k,{variant:"ghost",onClick:m},{default:v(()=>[...c[5]||(c[5]=[P("Bekor qilish",-1)])]),_:1}),o(k,{variant:"primary",onClick:g,loading:y.value},{default:v(()=>[P(D(l(f).loading?"Yuborilmoqda...":"Saqlash va yuborish"),1)]),_:1},8,["loading"])])]))}},Ve={class:"mx-auto"},Te={class:"grid grid-cols-1 lg:grid-cols-12"},Ie={class:"col-span-12 md:col-span-5 2xl:col-span-3"},Pe={class:"card-dark border-b-2 border-x shadow-sm"},Ee={class:"flex px-1 py-3 items-center border-b card-border justify-between"},He={class:"flex items-center"},Le={class:"flex gap-1"},Ue={class:"h-[calc(100vh-8rem)] overflow-y-auto"},Ne={class:"col-span-12 md:col-span-7 2xl:col-span-9 space-y-2 px-3 h-[calc(100vh-4rem)] overflow-y-auto"},Oe={class:"card-dark rounded-b border-b border-x"},Re={key:0},Ye={class:"flex px-1 py-2 items-center border-b card-border justify-between"},Be={class:"flex items-center gap-2"},Ke={class:"flex justify-end p-4 bg-[#F4F6FC]"},Qe={key:1,class:"flex flex-col"},ze={class:"grid grid-cols-3 p-6 gap-4"},Je={class:"flex bg-[#F4F6FC] items-center gap-4 justify-end p-6"},ht={__name:"TransmittedViews",setup(s){const e=B(),n=R(),f=[{label:"Qoralama hujjatlar",name:"draft"},{label:"Ro`yxatga olingan hujjatlar",name:"attached"}],x=g=>e.fetchAll(g),u=g=>{e.selectedDock=g},h=()=>{e.selectedDock=null},y=()=>e.fetchAll(1),i=()=>{e.status="",e.in_number="",e.out_number="",e.fetchAll(1)},m=()=>{e.selectedDock&&n.open(se,{id:e.selectedDock.id})},M=()=>{e.selectedDock&&n.open(ee,{selectedFile:e.selectedDock})},C=()=>{e.selectedDock&&n.open(N,{fileID:e.selectedDock.id})},A=()=>{e.selectedDock&&n.open(N,{file:e.selectedDock})};return X(()=>e.docks,g=>{if(e.selectedDock){const t=g.find(c=>c.id===e.selectedDock.id);t?e.selectedDock=t:e.selectedDock=null}},{deep:!0}),Y(()=>{e.fetchAll(1)}),(g,t)=>{const c=Z("wave");return d(),p("div",Ve,[a("div",Te,[a("div",Ie,[a("div",Pe,[a("div",Ee,[a("div",He,[W((d(),w(k,{onClick:h,variant:"hover"},{default:v(()=>[o(l(H),{"stroke-width":"2",class:"w-6 h-6"})]),_:1})),[[c]]),t[3]||(t[3]=a("h2",{class:"text-[14px] p-2 font-bold uppercase text-[#282F3D]"},"Hujjatlar",-1))]),a("div",Le,[o(le,{currentPage:l(e).pagination.currentPage,previous:l(e).pagination.previous,next:l(e).pagination.next,lastPage:Math.ceil(l(e).pagination.count/10),total:l(e).pagination.count,loading:l(e).loading,onChange:x},null,8,["currentPage","previous","next","lastPage","total","loading"])])]),a("div",Ue,[(d(!0),p(F,null,$(l(e).docks,r=>(d(),w(ve,{key:r.id,dock:r,active:l(e).selectedDock?.id===r.id,onSelect:u},null,8,["dock","active"]))),128)),t[4]||(t[4]=a("div",{class:"h-24 w-full"},null,-1))])])]),a("div",Ne,[a("div",Oe,[l(e).selectedDock?(d(),p("div",Re,[a("div",Ye,[t[7]||(t[7]=a("h2",{class:"text-[14px] p-2 font-bold uppercase text-[#282F3D]"},"Kiruvchi hujjat",-1)),a("div",Be,[o(k,{onClick:m,variant:"primary"},{default:v(()=>[o(l(oe),{"stroke-width":"3",class:"text-white"}),t[5]||(t[5]=a("span",{class:"px-1"},"Topshiriq yaratish",-1))]),_:1}),o(k,{onClick:M,variant:"primary"},{default:v(()=>[o(l(ne),{"stroke-width":"3",class:"text-white w-6 h-4"}),t[6]||(t[6]=a("span",{class:"px-1"},"Tahrirlash",-1))]),_:1})])]),o(be,{dockfile:l(e).selectedDock,class:"p-6"},null,8,["dockfile"]),a("div",Ke,[l(e).selectedDock?.attachments?.length?(d(),w(k,{key:0,onClick:A,variant:"primary"},{default:v(()=>[o(l(U),{"stroke-width":"2",class:"text-white"}),t[8]||(t[8]=a("span",{class:"px-1"},"File va ilovani yangilash",-1))]),_:1})):(d(),w(k,{key:1,onClick:C,variant:"primary"},{default:v(()=>[o(l(U),{"stroke-width":"2",class:"text-white"}),t[9]||(t[9]=a("span",{class:"px-1"},"File va ilova qo'shish",-1))]),_:1}))])])):(d(),p("div",Qe,[a("div",null,[t[10]||(t[10]=a("div",{class:"flex p-3 items-center card-border border-b justify-between"},[a("h2",{class:"text-[14px] py-2 font-bold uppercase text-[#282F3D]"},"Qidirish")],-1)),a("div",ze,[o(G,{modelValue:l(e).status,"onUpdate:modelValue":t[0]||(t[0]=r=>l(e).status=r),options:f,"option-label":"label","option-value":"name",placeholder:"Hujjat holati"},null,8,["modelValue"]),o(E,{modelValue:l(e).in_number,"onUpdate:modelValue":t[1]||(t[1]=r=>l(e).in_number=r),placeholder:"Hujjat raqami"},null,8,["modelValue"]),o(E,{modelValue:l(e).out_number,"onUpdate:modelValue":t[2]||(t[2]=r=>l(e).out_number=r),placeholder:"Chiqish raqami"},null,8,["modelValue"])])]),a("div",Je,[o(k,{class:"flex items-center",onClick:i},{default:v(()=>[o(l(ie),{"stroke-width":"2.5",class:"w-5 h-5"}),t[11]||(t[11]=a("span",{class:"px-2"},"Tozalash",-1))]),_:1}),o(k,{variant:"primary",class:"flex items-center",onClick:y},{default:v(()=>[o(l(H),{"stroke-width":"2.5",class:"w-5 h-5"}),t[12]||(t[12]=a("span",{class:"px-2"},"Qidirish",-1))]),_:1})])]))])])])])}}};export{ht as default};
