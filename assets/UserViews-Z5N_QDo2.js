import{u as B}from"./usersStore-V3-vT8sK.js";import{u as F,x as U,r as b,a as y,o as g,b as s,g as o,h as c,f as e,X as q,j as w,B as P,l as S,v as _,w as D,R as M,c as T,F as Y,C as E,O as L}from"./index-DirDpiKz.js";import{B as N}from"./BaseCrudTable-BSc-cSqg.js";import{_ as O}from"./UPagination-DJxMvXfm.js";import{u as A,S as R}from"./useFormValidate-DiuR9UEs.js";import{u as X}from"./departmentStore-Cxlc1uaN.js";import{u as G}from"./user-BRUuMk4P.js";import{T as H}from"./trash-2-Dshkx7mY.js";import{I as J}from"./IconBG-CnmyzwLi.js";import{P as K}from"./plus-B6npwRQp.js";/* empty css                                                                      */import"./chevron-left-E387xrtc.js";import"./chevron-right-Dqrbvz1g.js";const Q={class:"max-w-xl max-h-xl"},W={class:"flex justify-between modal-border items-center p-[14px] border-b"},Z={class:"justify-end border-t modal-card flex gap-2 p-4"},ee={__name:"UserDelete",props:{userId:{type:Number,required:!0}},setup(x){const i=x,r=B(),h=F(),d=U(),f=async()=>{try{await r.removeUser(i.userId),h.show("Foydalanuvchi muvaffaqiyatli o‘chirildi!","success"),d.close()}catch(u){h.show("Xatolik yuz berdi!","error"),console.error(u)}};return(u,n)=>{const t=b("UButton");return g(),y("div",Q,[s("div",W,[n[2]||(n[2]=s("p",{class:"text-dark text-lg font-semibold"},"Foydalanuvchini o‘chirish",-1)),o(t,{customClass:"bg-[#475467] rounded-full p-1",onClick:n[0]||(n[0]=l=>e(d).close())},{default:c(()=>[o(e(q),{"stroke-width":"3",class:"w-4 h-4 text-white"})]),_:1})]),n[5]||(n[5]=s("div",{class:"p-4 text-center space-y-4"},[s("p",{class:"text-base text-dark"}," Siz rostdan ham bu foydalanuvchini o‘chirmoqchimisiz? ")],-1)),s("div",Z,[o(t,{variant:"ghost",onClick:n[1]||(n[1]=l=>e(d).close()),disabled:e(r).loading},{default:c(()=>[...n[3]||(n[3]=[w(" Bekor qilish ",-1)])]),_:1},8,["disabled"]),o(t,{variant:"danger",onClick:f,loading:e(r).loading},{default:c(()=>[...n[4]||(n[4]=[w(" O‘chirish ",-1)])]),_:1},8,["loading"])])])}}},se={class:"flex flex-col max-w-2xl"},te={class:"flex justify-between modal-border items-center p-[14px] border-b"},ae={class:"text-black text-md font-bold uppercase"},oe={class:"flex flex-wrap -mx-2 p-4"},le={class:"w-full px-2 py-2 xl:w-1/2"},re={class:"w-full px-2 py-2 xl:w-1/2"},ie={class:"w-full px-2 py-2 xl:w-1/2"},ne={class:"w-full px-2 py-2 xl:w-1/2"},de={class:"w-full px-2 py-2 xl:w-1/2"},me={class:"w-full px-2 py-2 xl:w-1/2"},ue={class:"w-full px-2 py-2 xl:w-1/2"},pe={class:"w-full px-2 py-2 xl:w-1/2"},ce={class:"justify-end border-t modal-card modal-border flex items-center p-4 gap-2"},C={__name:"UserForm",props:{userId:{type:Number,default:null}},setup(x){const i=x,r=B(),h=X();F();const d=U(),f=P(()=>!!i.userId),u={id:"",username:"",email:"",last_name:"",first_name:"",father_name:"",position:"",department_id:"",password:""},n={username:{required:!0,message:"Ism majburiy"},email:{required:!0,message:"Email majburiy"},last_name:{required:!0,message:"Familiya majburiy"},first_name:{required:!0,message:"Sharif majburiy"},father_name:{required:!0,message:"Otasining ismi majburiy"},position:{required:!0,message:"Lavozim majburiy"},department_id:{required:!0,message:"Bo‘lim majburiy"},password:{required:!i.userId,message:"Parol majburiy"}},{form:t,errors:l,validate:k,resetForm:I}=A(u,n);S(async()=>{const p=[];if(h.departments.length||p.push(h.fetchAll()),i.userId&&p.push(r.fetchUser(i.userId)),await Promise.all(p),i.userId&&r.selectedUser){const a=r.selectedUser;t.username=a.username,t.last_name=a.last_name,t.first_name=a.first_name,t.father_name=a.father_name,t.position=a.position,t.email=a.email,t.department_id=a.department?.id}});const V=()=>{I(),d.close()},j=async()=>{if(!(!k()||r.loading))try{const p={...t};f.value||delete p.id,p.password||delete p.password,f.value?await r.editUser(i.userId,p):await r.addUser(p),V()}catch(p){console.error(p)}};return(p,a)=>{const $=b("UButton"),v=b("UInput"),z=b("USelect");return g(),y("div",se,[s("div",te,[s("p",ae,_(f.value?"Foydalanuvchini tahrirlash":"Foydalanuvchi qo‘shish"),1),o($,{customClass:"bg-[#475467] rounded-full p-1",onClick:V},{default:c(()=>[o(e(q),{"stroke-width":"3",class:"w-4 h-4 text-white"})]),_:1})]),s("form",{onSubmit:D(j,["prevent"]),class:"space-y-6"},[s("div",oe,[s("div",le,[o(v,{modelValue:e(t).username,"onUpdate:modelValue":a[0]||(a[0]=m=>e(t).username=m),label:"Foydalanuvchi nomi",placeholder:"Foydalanuvchi nomini kiriting",error:e(l).username},null,8,["modelValue","error"])]),s("div",re,[o(v,{modelValue:e(t).email,"onUpdate:modelValue":a[1]||(a[1]=m=>e(t).email=m),label:"Email",placeholder:"Email manzilingizni kiriting",error:e(l).email},null,8,["modelValue","error"])]),s("div",ie,[o(v,{modelValue:e(t).last_name,"onUpdate:modelValue":a[2]||(a[2]=m=>e(t).last_name=m),label:"Familiya",placeholder:"Familiyangizni kiriting",error:e(l).last_name},null,8,["modelValue","error"])]),s("div",ne,[o(v,{modelValue:e(t).first_name,"onUpdate:modelValue":a[3]||(a[3]=m=>e(t).first_name=m),label:"Ismingiz",placeholder:"Ismingizni kiriting",error:e(l).first_name},null,8,["modelValue","error"])]),s("div",de,[o(v,{modelValue:e(t).father_name,"onUpdate:modelValue":a[4]||(a[4]=m=>e(t).father_name=m),label:"Otasining ismi",placeholder:"Otasining ismini kiriting",error:e(l).father_name},null,8,["modelValue","error"])]),s("div",me,[o(z,{modelValue:e(t).department_id,"onUpdate:modelValue":a[5]||(a[5]=m=>e(t).department_id=m),label:"Bo‘lim",options:e(h).departments,"option-label":"name","option-value":"id",placeholder:"Bo‘lim kiriting",error:e(l).department_id},null,8,["modelValue","options","error"])]),s("div",ue,[o(v,{modelValue:e(t).position,"onUpdate:modelValue":a[6]||(a[6]=m=>e(t).position=m),label:"Lavozim",placeholder:"Lavozim kiriting",error:e(l).position},null,8,["modelValue","error"])]),s("div",pe,[o(v,{modelValue:e(t).password,"onUpdate:modelValue":a[7]||(a[7]=m=>e(t).password=m),type:"password",label:"Parol",placeholder:"Parolni yangilamoqchi bo‘lsangiz kiriting",error:e(l).password},null,8,["modelValue","error"])])]),s("div",ce,[o($,{variant:"ghost",type:"button",onClick:V,disabled:e(r).loading},{default:c(()=>[...a[8]||(a[8]=[w(" Bekor qilish ",-1)])]),_:1},8,["disabled"]),o($,{type:"submit",variant:"primary",loading:e(r).loading,disabled:e(r).loading},{default:c(()=>[w(_(e(r).loading?"Yuborilmoqda...":f.value?"Yangilash":"Saqlash"),1)]),_:1},8,["loading","disabled"])])],32)])}}},fe={class:"table-header flex gap-3"},_e=["src"],he={class:"text-sm text-gray-500"},ve={class:"table-header"},be={class:"table-header"},ge={class:"bg-blue-500 text-white px-2 rounded"},xe={class:"table-header"},ye={class:"table-header"},we={class:"table-header"},Ue={class:"p-4 sticky bottom-0"},ke={__name:"UserList",setup(x){const i=B(),r=U();M();const h=u=>i.fetchUsers(u);S(()=>{i.fetchUsers()});const d=u=>r.open(ee,{userId:u}),f=(u=null)=>r.open(C,{userId:u});return(u,n)=>{const t=b("UButton");return g(),T(N,null,{thead:c(()=>[...n[0]||(n[0]=[s("th",{class:"table-header uppercase"},"Foydalanuvchi",-1),s("th",{class:"table-header uppercase"},"Isim familiyasi ochistvasi",-1),s("th",{class:"table-header uppercase"},"Role",-1),s("th",{class:"table-header uppercase"},"Bo‘lim",-1),s("th",{class:"table-header uppercase"},"Yaratilgan sana",-1),s("th",{class:"table-header uppercase"},"Tahrirlash",-1)])]),tbody:c(()=>[(g(!0),y(Y,null,E(e(i).users,l=>(g(),y("tr",{key:l.id,class:"hover:bg-[#F4F6FC] divide-x"},[s("td",fe,[s("img",{src:l.avatar||e(G),class:"w-10 h-10 rounded-full"},null,8,_e),s("div",null,[s("div",null,_(l.username),1),s("div",he,_(l.email),1)])]),s("td",ve,_(l.last_name)+" "+_(l.first_name)+" "+_(l.father_name),1),s("td",be,[s("span",ge,_(l.groups?.[0]),1)]),s("td",xe,_(l.department?.name),1),s("td",ye,_(e(L)(l.created_at).format("DD MMMM YYYY")),1),s("td",we,[o(t,{variant:"hover",onClick:k=>f(l.id)},{default:c(()=>[o(e(R),{class:"w-5 h-5"})]),_:1},8,["onClick"]),o(t,{variant:"hover",onClick:k=>d(l.id)},{default:c(()=>[o(e(H),{class:"w-5 h-5 text-red-500"})]),_:1},8,["onClick"])])]))),128))]),pagination:c(()=>[s("div",Ue,[o(O,{total:e(i).pagination.count,currentPage:e(i).pagination.previous,lastPage:e(i).pagination.next,onChange:h},null,8,["total","currentPage","lastPage"])])]),_:1})}}},Ve={class:"overflow-y-scroll h-screen"},$e={class:"flex flex-col gap-2 items-center p-2"},Be={class:"relative rounded-md flex bg-[#0F172A] shadow-sm flex-col gap-5 sm:flex-row sm:items-center sm:justify-between p-6 w-full overflow-hidden"},Fe={class:"flex flex-col p-6 w-full"},Ne={__name:"UserViews",setup(x){const i=U();function r(){i.open(C)}return(h,d)=>{const f=b("UButton");return g(),y("div",Ve,[s("div",$e,[s("div",Be,[o(J),d[2]||(d[2]=s("h3",{class:"text-md font-extrabold uppercase text-gray-100"}," Tizim foydalanuvchilari ",-1)),o(f,{class:"z-10",variant:"primary",onClick:d[0]||(d[0]=u=>r())},{default:c(()=>[o(e(K),{"stroke-width":"3"}),d[1]||(d[1]=s("span",{class:"px-1"},"Foydalanuvchi qo‘shish",-1))]),_:1})]),s("div",Fe,[o(ke),d[3]||(d[3]=s("div",{class:"w-full h-44"},null,-1))])])])}}};export{Ne as default};
